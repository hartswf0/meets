<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
    <title>NEON ARENA // ARCHIVE (Reader-First)</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Orbitron:wght@900&family=JetBrains+Mono:wght@400;700&family=Inter:wght@400;600;700&display=swap"
        rel="stylesheet">

    <!-- Icons -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>

    <style>
        :root {
            --neon-cyan: #00ffff;
            --neon-magenta: #ff00ff;
            --neon-yellow: #ffff00;
            --neon-green: #00ff00;

            --bg: #000;
            --panel: #0b0b0b;
            --panel2: #111;
            --border: #222;
            --text: #e7e7e7;
            --muted: #8a8a8a;

            --accent: var(--neon-yellow);
            --p1: #00ffff;
            --p2: #ff00ff;

            --ui-font: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
            --title-font: "Orbitron", system-ui, sans-serif;
            --read-font: "Inter", system-ui, -apple-system, Segoe UI, Roboto, sans-serif;

            --sidebar-w: 320px;
            --appbar-h: 56px;
            --tabs-h: 44px;

            --pad: 16px;
            --r: 10px;

            --read-size: 16px;
            --read-line: 1.85;

            --safe-top: env(safe-area-inset-top, 0px);
            --safe-bot: env(safe-area-inset-bottom, 0px);
            --safe-left: env(safe-area-inset-left, 0px);
            --safe-right: env(safe-area-inset-right, 0px);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0
        }

        html,
        body {
            height: 100%
        }

        body {
            background: var(--bg);
            color: var(--text);
            font-family: var(--ui-font);
            -webkit-font-smoothing: antialiased;
            overflow: hidden;
            /* app handles scrolling internally */
        }

        /* Optional scanline (default mild, can disable) */
        body[data-scanlines="on"]::after {
            content: "";
            position: fixed;
            inset: 0;
            pointer-events: none;
            background: repeating-linear-gradient(0deg,
                    transparent, transparent 2px,
                    rgba(255, 255, 255, 0.03) 2px,
                    rgba(255, 255, 255, 0.03) 3px);
            opacity: 0.08;
            z-index: 1000;
        }

        @media (max-width: 768px) {
            body[data-scanlines="on"]::after {
                opacity: 0.05
            }
        }

        @media (prefers-reduced-motion: reduce) {
            body::after {
                display: none !important
            }
        }

        /* App layout */
        #app {
            height: 100%;
            display: grid;
            grid-template-columns: var(--sidebar-w) 1fr;
            overflow: hidden;
        }

        /* Sidebar */
        #sidebar {
            background: var(--panel2);
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            min-width: 0;
        }

        #sbTop {
            padding: calc(12px + var(--safe-top)) 12px 12px 12px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
        }

        #sbBrand {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            user-select: none;
        }

        #sbBrand .logo {
            width: 28px;
            height: 28px;
            display: grid;
            place-items: center;
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--accent);
            background: #050505;
        }

        #sbBrand .name {
            font-family: var(--title-font);
            letter-spacing: 2px;
            font-size: 13px;
            color: var(--accent);
            text-shadow: 0 0 10px color-mix(in srgb, var(--accent) 60%, transparent);
            text-transform: uppercase;
            white-space: nowrap;
        }

        .iconBtn {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            border: 1px solid var(--border);
            background: #050505;
            color: var(--muted);
            display: grid;
            place-items: center;
            cursor: pointer;
            transition: transform .08s, border-color .12s, color .12s;
        }

        .iconBtn:hover {
            border-color: color-mix(in srgb, var(--accent) 55%, var(--border));
            color: var(--accent)
        }

        .iconBtn:active {
            transform: scale(0.98)
        }

        #sbSearch {
            padding: 10px 12px;
            border-bottom: 1px solid var(--border);
            display: flex;
            gap: 8px;
            align-items: center;
        }

        #searchInput {
            flex: 1;
            height: 40px;
            border-radius: 10px;
            border: 1px solid var(--border);
            background: #050505;
            color: var(--neon-green);
            padding: 0 12px;
            font-family: var(--ui-font);
            font-size: 12px;
            outline: none;
        }

        #searchInput::placeholder {
            color: color-mix(in srgb, var(--muted) 60%, transparent)
        }

        #searchInput:focus {
            border-color: color-mix(in srgb, var(--neon-green) 65%, var(--border))
        }

        #list {
            overflow: auto;
            padding: 6px 0;
        }

        .item {
            padding: 12px 14px;
            border-bottom: 1px solid #141414;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            gap: 4px;
            transition: background .12s;
        }

        .item:hover {
            background: #121212
        }

        .item.active {
            background: #141414;
            border-left: 3px solid var(--accent);
        }

        .tag {
            font-size: 10px;
            letter-spacing: 1px;
            color: var(--muted);
        }

        .title {
            font-size: 12px;
            font-weight: 700;
            color: var(--text);
        }

        .sub {
            font-size: 11px;
            color: color-mix(in srgb, var(--muted) 75%, transparent);
            line-height: 1.3;
        }

        /* Main */
        #main {
            min-width: 0;
            display: flex;
            flex-direction: column;
            background: var(--bg);
            overflow: hidden;
        }

        /* Appbar */
        #appbar {
            height: calc(var(--appbar-h) + var(--safe-top));
            padding: calc(10px + var(--safe-top)) calc(var(--pad) + var(--safe-right)) 10px calc(var(--pad) + var(--safe-left));
            border-bottom: 1px solid var(--border);
            background: linear-gradient(180deg, #0d0d0d, #080808);
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
        }

        #appbarLeft {
            display: flex;
            align-items: center;
            gap: 10px;
            min-width: 0;
        }

        #matchMeta {
            display: flex;
            flex-direction: column;
            gap: 2px;
            min-width: 0;
        }

        #meetLine {
            font-family: var(--title-font);
            letter-spacing: 1.6px;
            font-size: 12px;
            color: var(--accent);
            text-transform: uppercase;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        #logline {
            font-family: var(--ui-font);
            font-size: 11px;
            letter-spacing: .10em;
            text-transform: uppercase;
            color: color-mix(in srgb, var(--muted) 75%, transparent);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        #appbarRight {
            display: flex;
            align-items: center;
            gap: 8px;
            flex-shrink: 0;
        }

        .pill {
            height: 32px;
            padding: 0 10px;
            border-radius: 999px;
            border: 1px solid var(--border);
            background: #050505;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 11px;
            color: var(--muted);
            letter-spacing: .12em;
            text-transform: uppercase;
            user-select: none;
        }

        .pill b {
            color: var(--accent)
        }

        .pill .dot {
            width: 8px;
            height: 8px;
            border-radius: 99px;
            background: var(--accent);
            box-shadow: 0 0 12px color-mix(in srgb, var(--accent) 55%, transparent);
        }

        /* Tabs (mobile-friendly) */
        #tabs {
            height: var(--tabs-h);
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 0 calc(var(--pad) + var(--safe-right)) 0 calc(var(--pad) + var(--safe-left));
            border-bottom: 1px solid var(--border);
            background: #070707;
        }

        .tab {
            height: 34px;
            padding: 0 12px;
            border-radius: 999px;
            border: 1px solid var(--border);
            background: #050505;
            color: var(--muted);
            font-size: 12px;
            letter-spacing: .10em;
            text-transform: uppercase;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            user-select: none;
            white-space: nowrap;
        }

        .tab.active {
            border-color: color-mix(in srgb, var(--accent) 60%, var(--border));
            color: var(--accent);
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.02) inset;
        }

        /* Content area (scrolls) */
        #content {
            flex: 1;
            overflow: auto;
            padding: calc(var(--pad) + 4px) calc(var(--pad) + var(--safe-right)) calc(var(--pad) + var(--safe-bot) + 10px) calc(var(--pad) + var(--safe-left));
        }

        /* Reader-first typography */
        .readWrap {
            max-width: 80ch;
            margin: 0 auto;
        }

        .h1 {
            font-family: var(--title-font);
            color: var(--neon-cyan);
            text-shadow: 0 0 18px color-mix(in srgb, var(--neon-cyan) 40%, transparent);
            font-size: clamp(18px, 2.4vw, 24px);
            letter-spacing: 1.2px;
            text-transform: uppercase;
            margin-bottom: 8px;
        }

        .lede {
            font-family: var(--read-font);
            font-size: calc(var(--read-size) + 1px);
            line-height: var(--read-line);
            color: color-mix(in srgb, var(--text) 92%, #000);
            margin-bottom: 16px;
        }

        .metaRow {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 14px 0 18px;
        }

        .chip {
            border: 1px solid var(--border);
            background: var(--panel);
            color: var(--muted);
            border-radius: 999px;
            padding: 8px 10px;
            font-size: 11px;
            letter-spacing: .08em;
            text-transform: uppercase;
            display: flex;
            align-items: center;
            gap: 8px;
            white-space: nowrap;
        }

        .chip strong {
            color: var(--accent)
        }

        .chip .mini {
            width: 8px;
            height: 8px;
            border-radius: 999px;
            background: var(--accent);
        }

        .card {
            border: 1px solid var(--border);
            background: linear-gradient(180deg, #0a0a0a, #060606);
            border-radius: var(--r);
            padding: 14px;
            margin: 12px 0;
        }

        .cardTitle {
            display: flex;
            align-items: baseline;
            justify-content: space-between;
            gap: 12px;
            margin-bottom: 10px;
        }

        .cardTitle h3 {
            font-family: var(--ui-font);
            font-weight: 700;
            letter-spacing: .12em;
            font-size: 12px;
            text-transform: uppercase;
            color: var(--text);
        }

        .cardTitle .mut {
            font-size: 11px;
            color: var(--muted);
            text-transform: uppercase;
            letter-spacing: .10em;
            white-space: nowrap;
        }

        .prose {
            font-family: var(--read-font);
            font-size: var(--read-size);
            line-height: var(--read-line);
            color: color-mix(in srgb, var(--text) 92%, #000);
            word-break: break-word;
            overflow-wrap: anywhere;
        }

        .prose p {
            margin: 0 0 14px 0
        }

        .prose p:last-child {
            margin-bottom: 0
        }

        .btnRow {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }

        .btn {
            height: 38px;
            padding: 0 12px;
            border-radius: 10px;
            border: 1px solid var(--border);
            background: #050505;
            color: var(--muted);
            font-family: var(--ui-font);
            font-size: 12px;
            letter-spacing: .08em;
            text-transform: uppercase;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            border-color: color-mix(in srgb, var(--accent) 55%, var(--border));
            color: var(--accent)
        }

        .btn.primary {
            border-color: color-mix(in srgb, var(--accent) 65%, var(--border));
            color: var(--bg);
            background: var(--accent);
            font-weight: 700;
        }

        /* Arena view */
        .arenaGrid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            max-width: 980px;
            margin: 0 auto;
        }

        @media (max-width: 820px) {
            .arenaGrid {
                grid-template-columns: 1fr
            }
        }

        .fighter {
            border: 1px solid var(--border);
            background: var(--panel);
            border-radius: var(--r);
            padding: 14px;
            position: relative;
            overflow: hidden;
        }

        .fighter::before {
            content: "";
            position: absolute;
            inset: -40px -40px auto auto;
            width: 140px;
            height: 140px;
            border-radius: 999px;
            background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.10), transparent 60%);
            pointer-events: none;
            opacity: .35;
        }

        .fighterHeader {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            gap: 10px;
            margin-bottom: 10px;
        }

        .fname {
            font-family: var(--title-font);
            font-size: 18px;
            letter-spacing: 1.2px;
            text-transform: uppercase;
            line-height: 1.1;
            white-space: pre-line;
        }

        .ftype {
            font-size: 11px;
            letter-spacing: .14em;
            text-transform: uppercase;
            color: var(--muted);
            margin-top: 6px;
        }

        .score {
            font-family: var(--title-font);
            font-size: 44px;
            line-height: 1;
            letter-spacing: 1px;
            text-shadow: 0 0 18px currentColor;
        }

        .kv {
            display: flex;
            justify-content: space-between;
            gap: 10px;
            font-size: 12px;
            padding: 8px 0;
            border-top: 1px dashed #1d1d1d;
            color: var(--text);
        }

        .kv span:last-child {
            color: currentColor;
            font-weight: 700
        }

        .verdictLine {
            margin-top: 10px;
            border: 1px solid color-mix(in srgb, currentColor 55%, var(--border));
            color: currentColor;
            background: rgba(0, 0, 0, 0.35);
            padding: 8px 10px;
            border-radius: 10px;
            font-size: 12px;
            letter-spacing: .12em;
            text-transform: uppercase;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        /* Compare table (mobile-friendly: stacked) */
        .cmp {
            margin-top: 10px;
            border-top: 1px solid #141414;
        }

        .cmpRow {
            padding: 10px 0;
            border-bottom: 1px solid #141414;
            display: grid;
            grid-template-columns: 1fr;
            gap: 6px;
        }

        .cmpRow .k {
            font-size: 11px;
            letter-spacing: .12em;
            text-transform: uppercase;
            color: var(--muted);
        }

        .cmpRow .ab {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            font-family: var(--read-font);
            font-size: 14px;
            line-height: 1.5;
        }

        .cmpRow .ab div {
            border: 1px solid #1a1a1a;
            background: #070707;
            border-radius: 10px;
            padding: 10px;
        }

        /* Mobile: sidebar becomes overlay */
        #scrim {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.55);
            z-index: 900;
        }

        @media (max-width: 900px) {
            #app {
                grid-template-columns: 1fr
            }

            #sidebar {
                position: fixed;
                top: 0;
                left: 0;
                bottom: 0;
                width: min(var(--sidebar-w), 88vw);
                transform: translateX(-102%);
                z-index: 1000;
                transition: transform .18s ease;
                box-shadow: 20px 0 50px rgba(0, 0, 0, 0.55);
            }

            body[data-sb="open"] #sidebar {
                transform: translateX(0)
            }

            body[data-sb="open"] #scrim {
                display: block
            }
        }

        /* Reader size presets */
        body[data-reader="compact"] {
            --read-size: 15px;
            --read-line: 1.75;
        }

        body[data-reader="normal"] {
            --read-size: 16px;
            --read-line: 1.85;
        }

        body[data-reader="large"] {
            --read-size: 18px;
            --read-line: 1.9;
        }

        /* Focus outlines */
        :focus-visible {
            outline: 2px solid color-mix(in srgb, var(--accent) 70%, transparent);
            outline-offset: 2px;
            border-radius: 10px;
        }
    </style>
</head>

<body data-reader="normal" data-scanlines="on">
    <div id="scrim" onclick="closeSidebar()"></div>

    <div id="app">
        <!-- SIDEBAR -->
        <aside id="sidebar" aria-label="Match list">
            <div id="sbTop">
                <div id="sbBrand" onclick="closeSidebar()" title="Close (mobile)">
                    <div class="logo"><i class="fa-solid fa-bars"></i></div>
                    <div class="name">Arena Archive</div>
                </div>
                <button class="iconBtn" onclick="randomMatch()" title="Random (R)" aria-label="Random match">
                    <i class="fa-solid fa-dice"></i>
                </button>
            </div>

            <div id="sbSearch">
                <input id="searchInput" type="text" placeholder="SEARCH MATCHES…" aria-label="Search matches" />
                <button class="iconBtn" onclick="focusSearch()" title="Search (/)" aria-label="Focus search">
                    <i class="fa-solid fa-magnifying-glass"></i>
                </button>
            </div>

            <div id="list"></div>
        </aside>

        <!-- MAIN -->
        <main id="main">
            <!-- APP BAR: reader-first meets line + logline -->
            <header id="appbar">
                <div id="appbarLeft">
                    <button class="iconBtn" onclick="toggleSidebar()" title="Menu (M)" aria-label="Open menu">
                        <i class="fa-solid fa-bars"></i>
                    </button>
                    <div id="matchMeta">
                        <div id="meetLine">THE ___ MEETS THE ___</div>
                        <div id="logline">---</div>
                    </div>
                </div>

                <div id="appbarRight">
                    <div class="pill" title="Match ID">
                        <span class="dot"></span>
                        <span>ID</span>
                        <b id="matchIdPill">M-00</b>
                    </div>

                    <button class="iconBtn" onclick="prevMatch()" title="Prev (← / ↑)" aria-label="Previous match">
                        <i class="fa-solid fa-chevron-left"></i>
                    </button>
                    <button class="iconBtn" onclick="nextMatch()" title="Next (→ / ↓)" aria-label="Next match">
                        <i class="fa-solid fa-chevron-right"></i>
                    </button>

                    <button class="iconBtn" onclick="cycleReader()" title="Text size (A)" aria-label="Cycle text size">
                        <i class="fa-solid fa-font"></i>
                    </button>
                    <button class="iconBtn" onclick="toggleScanlines()" title="Scanlines" aria-label="Toggle scanlines">
                        <i class="fa-solid fa-grip-lines"></i>
                    </button>
                </div>
            </header>

            <!-- TABS -->
            <nav id="tabs" aria-label="Views">
                <div class="tab active" data-tab="read" onclick="setTab('read')"><i class="fa-solid fa-book"></i> Read
                </div>
                <div class="tab" data-tab="arena" onclick="setTab('arena')"><i class="fa-solid fa-bolt"></i> Arena</div>
                <div class="tab" data-tab="compare" onclick="setTab('compare')"><i class="fa-solid fa-table"></i>
                    Compare</div>
            </nav>

            <!-- CONTENT -->
            <section id="content">
                <!-- READ VIEW -->
                <div id="view-read" class="readWrap">
                    <div class="h1" id="essayTitle">Essay Preview</div>
                    <div class="lede" id="essayTeaser">Loading…</div>

                    <div class="metaRow" id="metaRow"></div>

                    <div class="card">
                        <div class="cardTitle">
                            <h3>Full Essay</h3>
                            <div class="mut"><span id="winnerTag">Winner: —</span></div>
                        </div>
                        <div class="prose" id="essayBody"></div>

                        <div class="btnRow">
                            <button class="btn" onclick="copyEssay()" aria-label="Copy essay">
                                <i class="fa-regular fa-copy"></i> Copy Essay
                            </button>
                            <button class="btn" onclick="copyVerdict()" aria-label="Copy verdict">
                                <i class="fa-regular fa-copy"></i> Copy Verdict
                            </button>
                            <button class="btn primary" onclick="setTab('arena')" aria-label="Go to arena view">
                                <i class="fa-solid fa-bolt"></i> Arena View
                            </button>
                        </div>
                    </div>

                    <div class="card">
                        <div class="cardTitle">
                            <h3>Dark Matter Guardian Verdict</h3>
                            <div class="mut">Summary</div>
                        </div>
                        <div class="prose" id="verdictText"></div>
                    </div>
                </div>

                <!-- ARENA VIEW -->
                <div id="view-arena" style="display:none;">
                    <div class="readWrap">
                        <div class="h1">Arena Scoreboard</div>
                        <div class="lede">Tap a card to skim the criteria. Swipe left/right anywhere to change matches.
                        </div>
                    </div>

                    <div class="arenaGrid" id="arenaGrid"></div>
                </div>

                <!-- COMPARE VIEW -->
                <div id="view-compare" style="display:none;">
                    <div class="readWrap">
                        <div class="h1">Comparison</div>
                        <div class="lede">Feature-by-feature contrast. Built to read on a phone without pinching or
                            scrolling sideways.</div>

                        <div class="card">
                            <div class="cardTitle">
                                <h3>Matrix</h3>
                                <div class="mut" id="cmpHeads">— vs —</div>
                            </div>

                            <div class="cmp" id="cmpTable"></div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script>
        /* DATABASE (your existing matches kept intact) */
        const matches = [
            {
                id: "M-12",
                title: "Metis vs Thin Plans",
                logline: "THE SOUL OF STATECRAFT",
                teaser: "On the outskirts of an ancient city—a sprawling labyrinth of twisting alleyways, modern boulevards, and haphazard extensions—two figures stand amidst a dusty construction site. The ground is littered building stones and philosophical debates about the nature of meaning itself.",
                essay: "On the outskirts of an ancient city—a sprawling labyrinth of twisting alleyways, modern boulevards, and haphazard extensions—two figures stand amidst a dusty construction site. The ground is littered with building stones: blocks, pillars, slabs, and beams.\n\nOne figure is THE BISHOP, a man of solemn demeanor, robed in the heavy velvet of classical antiquity. He gestures with a pointed finger, as if baptizing the world with nouns. The other is THE FOREMAN, a restless pragmatic figure in work boots, his pockets bristling with slide rules, glue pots, and crumpled diagrams.\n\n'Observe', says THE BISHOP, pointing to a flat piece of stone. 'Here is the essence of language. I point, and I utter the sound: Slab. A golden thread of association is instantly spun between the sound and the object. The word names the thing.'\n\nThe Foreman squints. 'And what happens when I say: Five slabs?' The Bishop hesitates. The Foreman presses: 'What did you picture? Five individual things? A numeral? A quantity?'",
                p1: {
                    name: "BISHOP\nAUGUSTINE",
                    type: "[AUGUSTINIAN REFERENTIAL]",
                    score: 35,
                    color: "#d4af37",
                    rgb: "212,175,55",
                    stats: [
                        { label: "Ontological Scope", val: "Narrow" },
                        { label: "Empirical Fidelity", val: "Low" },
                        { label: "Learning Mechanism", val: "Mentalist" }
                    ],
                    assessment: {
                        criteria: [
                            { name: "Ontological Scope", evidence: "Words name objects", critique: "Catastrophic Narrowing. Works for 'Table' but fails for 'Five'", verdict: "void" },
                            { name: "Acquisition", evidence: "Ostensive teaching", critique: "Mentalist Speculation. Assumes language of thought", verdict: "shadow" }
                        ],
                        summary: "Fatal Flaw: Fido-Fido Fallacy. Assumes every word functions like name-tag."
                    }
                },
                p2: {
                    name: "FOREMAN\nWITTGENSTEIN",
                    type: "[LANGUAGE-GAMES]",
                    score: 92,
                    color: "#00ffff",
                    rgb: "0,255,255",
                    stats: [
                        { label: "Empirical Fidelity", val: "High" },
                        { label: "Functional Scope", val: "Broad" },
                        { label: "Learning Mechanism", val: "Enculturation" }
                    ],
                    assessment: {
                        criteria: [
                            { name: "Empirical Fidelity", evidence: "Five Red Apples example", critique: "High Fidelity. Acknowledges different word functions", verdict: "light" },
                            { name: "Contextual Awareness", evidence: "Language as ancient city", critique: "Structural Integrity. Captures historical accumulation", verdict: "light" },
                            { name: "Handling Intent", evidence: "Understanding not hidden mental process", critique: "Strong but potentially dismissive of phenomenology", verdict: "shadow" }
                        ],
                        summary: "Toolbox analogy dissolves confusion. Language Games allow infinite variability."
                    }
                },
                comparison: [
                    ["Meaning", "Correlation (Word ↔ Object)", "Function (Word ↔ Tool)"],
                    ["Learning", "Ostensive Definition", "Training / Enculturation"],
                    ["Agency", "Mental (Internal Image)", "Kinetic (Public Action)"]
                ],
                verdict: "Bishop presents naive theory. Foreman presents robust modular theory accepting language as functional form of life."
            },
            {
                id: "M-13",
                title: "Fox vs Hedgehog",
                logline: "FORECASTING STYLES",
                teaser: "In a stark, brightly lit void, there exists a floating table. Upon it sits a collection of childish things: a red cube, a blue pyramid, a green box. There is no weather here, no history, and no ambiguity. This is the Micro-World where syntactic theories battle procedural semantics.",
                essay: "In a stark, brightly lit void, there exists a floating table. Upon it sits a collection of childish things: a red cube, a blue pyramid, a green box. There is no weather here, no history, and no ambiguity. This is the Micro-World.\n\nHovering above this table are two entities. One is THE SCRIBE, a creature made of paper and ink, holding a vast dictionary and a book of grammar rules. The Scribe sees the world as a stream of symbols to be diagrammed.\n\nThe other is THE GOLEM, a mechanical arm made of LISP code and procedural logic, connected to a single, unblinking eye. The Golem sees the world as a series of subroutines to be executed.\n\nThe Scribe begins: 'I have parsed your utterance. It is syntactically well-formed. According to my dictionary, \"pick\" is a verb, \"up\" is a preposition, and \"block\" is a noun.'\n\nThe Golem responds: 'I have executed your command. The block is now in my hand. What next?'",
                p1: {
                    name: "THE\nSCRIBE",
                    type: "[MODULAR SYNTAX]",
                    score: 40,
                    color: "#ff00ff",
                    rgb: "255,0,255",
                    stats: [
                        { label: "Parsing Efficiency", val: "Exponential" },
                        { label: "Ambiguity Handling", val: "Paralysis" },
                        { label: "World Model", val: "None" }
                    ],
                    assessment: {
                        criteria: [
                            { name: "Ambiguity", evidence: "Boy Plants dilemma", critique: "Critical Failure. Produces semantic nonsense", verdict: "shadow" },
                            { name: "Efficiency", evidence: "Tree construction complete", critique: "Bureaucratic Overhead. Wrong variable", verdict: "void" }
                        ],
                        summary: "Fatal Flaw: Horizontal Architecture. Elegant but pragmatically useless."
                    }
                },
                p2: {
                    name: "THE\nGOLEM",
                    type: "[PROCEDURAL SEMANTICS]",
                    score: 88,
                    color: "#00ff00",
                    rgb: "0,255,0",
                    stats: [
                        { label: "Parsing Efficiency", val: "Linear" },
                        { label: "Ambiguity Handling", val: "Inference" },
                        { label: "World Model", val: "Integrated" }
                    ],
                    assessment: {
                        criteria: [
                            { name: "Integration", evidence: "Vertical system with integrated faculties", critique: "High Efficacy. Models real-time processing", verdict: "light" },
                            { name: "Transparency", evidence: "Tracks goal-stack", critique: "Strong Audit Trail. Explainable AI", verdict: "light" },
                            { name: "Scope", evidence: "Blocks World constraint", critique: "Deceptive Simplicity. Finite domain", verdict: "shadow" }
                        ],
                        summary: "Data as Programs paradigm shift. God in shoebox - depth wins over breadth."
                    }
                },
                comparison: [
                    ["Architecture", "Horizontal (Stages)", "Vertical (Integrated)"],
                    ["Meaning", "Dictionary Definition", "Executable Procedure"],
                    ["Ambiguity", "Paralysis", "Inference via World Model"]
                ],
                verdict: "Scribe produces trees; Golem produces outcomes. Language understanding requires world model."
            },
            {
                id: "M-14",
                title: "Navigator vs Cartographer",
                logline: "THE MAP OF GRAMMAR",
                teaser: "The forest of Language is dense. It is a tangled thicket of words, recursive vines, and deep roots of meaning. Two explorers stand at the edge, preparing to chart a path through.",
                essay: "The forest of Language is dense. It is a tangled thicket of words, recursive vines, and deep roots of meaning. Two explorers stand at the edge, preparing to chart a path through.\n\nOne is THE CARTOGRAPHER (representing Transformational Grammar/Context-Free Rules). He carries a stack of transparent overlays and a compass fixed on \"Deep Structure.\" He believes the forest is an illusion hiding a perfect, logical grid below.\n\n‘To understand the forest’, The Cartographer declares, ‘we must peel back the chaotic surface. We must generate a \"Deep Structure\" tree—a pure, context-free skeleton. Then, we apply transformations—twisting and grafting the branches—until we reproduce the messy \"Surface Structure\" we see before us. We define the forest by rules of generation: S → NP + VP.’\n\nThe other explorer is THE NAVIGATOR (representing Systemic Grammar/PROGRAMMAR). She carries no fixed maps, but wears a toolbelt filled with procedural gadgets: pointers, registers, and interrupt signals. She views the forest not as a static grid, but as a series of choices to be navigated in real-time.\n\n‘Your maps are beautiful’, says The Navigator, ‘but I am not here to generate a forest. I am here to recognize a path. I do not care about the \"Deep Structure\" unless it helps me decide which way to turn right now. My method is not a rule-book; it is a program. It is a set of instructions: \"If you see a verb, check its features. If it is Transitive, look for an Object. If you hit the word 'and', stop everything and call the Conjunction Demon.\"’",
                p1: {
                    name: "CARTOGRAPHER\nCHOMSKY",
                    type: "[TRANSFORMATIONAL GENERATIVE]",
                    score: 50,
                    color: "#ff7043",
                    rgb: "255,112,67",
                    stats: [
                        { label: "Parsing Efficiency", val: "Exponential" },
                        { label: "Ambiguity Handling", val: "Rigidity" },
                        { label: "Semantic Integration", val: "Ignored" }
                    ],
                    assessment: {
                        criteria: [
                            { name: "Parsing Efficiency", evidence: "Unwind transformations", critique: "Practical Failure. Notoriously difficult", verdict: "shadow" },
                            { name: "Handling Ambiguity", evidence: "Deep Structure trees", critique: "Rigidity. Generates massive ambiguity", verdict: "void" }
                        ],
                        summary: "Fatal Flaw: Separation of generation from interpretation. Poor engineering."
                    }
                },
                p2: {
                    name: "NAVIGATOR\nWINOGRAD",
                    type: "[SYSTEMIC PROGRAMMAR]",
                    score: 85,
                    color: "#a78bfa",
                    rgb: "167,139,250",
                    stats: [
                        { label: "Grammar as Program", val: "Executable" },
                        { label: "Systemic Features", val: "Semantic" },
                        { label: "Complexity", val: "Linear" }
                    ],
                    assessment: {
                        criteria: [
                            { name: "Grammar as Program", evidence: "PARSE, ISQ, BRANCH logic", critique: "High Efficacy. Aligns with how computers work", verdict: "light" },
                            { name: "Systemic Features", evidence: "MOOD, TRANSITIVITY networks", critique: "Semantic Relevance. Maps to meaning", verdict: "light" },
                            { name: "Handling Complexity", evidence: "And Demon for conjunctions", critique: "Ad-Hoc but Effective. Trades purity for performance", verdict: "shadow" }
                        ],
                        summary: "Syntax is Control. Executable code bypasses combinatorial explosion."
                    }
                },
                comparison: [
                    ["Architecture", "Static Tree", "Dynamic Flow"],
                    ["Grammar", "Rules (S→NP VP)", "Procedures"],
                    ["Semantics", "Ignored until end", "Checked continuously"]
                ],
                verdict: "Navigator demonstrates Syntax is Control. Systemic Grammar ensures parser output is meaningful features ready for semantics."
            },
            {
                id: "M-15",
                title: "Anatomist vs Architect",
                logline: "THE DESIGN OF THE SELF",
                teaser: "In the dusty wings of the Grand Theater of Being, where the costumes of history hang in endless rows, two figures stand over a sleeping actor. The actor is dressed in the elaborate, gilded silks of a Javanese dancer.",
                essay: "In the dusty wings of the Grand Theater of Being, where the costumes of history hang in endless rows, two figures stand over a sleeping actor. The actor is dressed in the elaborate, gilded silks of a Javanese dancer.\n\nOne figure is THE ANATOMIST. He holds a scalpel and a set of calipers. He is a child of the Enlightenment, a disciple of Newton and Bacon. He believes that truth is a solid, immutable core buried beneath layers of debris.\n\n'He is asleep', says The Anatomist, eyeing the Javanese dancer. 'And while he sleeps, he is trapped in that costume. To understand him—to understand Man—we must strip him. We must peel away the silk, the batik, the golden fingernails. These are mere accretions. They are the \"garb and appearance\" of local custom. Beneath them lies the Universal Man—the naked reasoner, unchanged by time or place, moved by the same passions that moved the Greeks.'\n\nThe other figure is THE ARCHITECT. He carries no scalpel, but a set of blueprints and a flow-chart. He sees the actor not as a core to be uncovered, but as a structure that has been built.\n\n‘Stop’, commands The Architect. 'You think you are stripping away a costume. In reality, you are dismantling the man himself. If you peel away his culture—his Javanese reverence, his specific way of smiling, his intricate etiquette—you will not find a \"Universal Man.\" You will find a monstrosity.'",
                p1: {
                    name: "ANATOMIST\nENLIGHTENMENT",
                    type: "[STRATIGRAPHIC MODEL]",
                    score: 30,
                    color: "#ff7043",
                    rgb: "255,112,67",
                    stats: [
                        { label: "Ontological Scope", val: "Narrow" },
                        { label: "Empirical Fidelity", val: "Low" },
                        { label: "Co-Evolution", val: "Denied" }
                    ],
                    assessment: {
                        criteria: [
                            { name: "Substantiality of Universals", evidence: "Claims inward motions arise from same desires", critique: "Fake Universals. Fails to define with specific content", verdict: "shadow" },
                            { name: "Layer-Cake Model", evidence: "Peel off cultural layer to find biological bedrock", critique: "Biological Fallacy. Ignores co-evolution evidence", verdict: "void" }
                        ],
                        summary: "Fatal Flaw: Onion Fallacy. Stripping particular reveals nothing functioning."
                    }
                },
                p2: {
                    name: "ARCHITECT\nGEERTZ",
                    type: "[CONTROL MECHANISM]",
                    score: 94,
                    color: "#00ff88",
                    rgb: "0,255,136",
                    stats: [
                        { label: "Information Gap", val: "Bridge" },
                        { label: "Co-Evolution", val: "Integrated" },
                        { label: "Particularity", val: "Essential" }
                    ],
                    assessment: {
                        criteria: [
                            { name: "Information Gap", evidence: "Man desperately dependent on extragenetic control", critique: "High Empirical Fidelity. Aligns with neurology", verdict: "light" },
                            { name: "Rejection of Typology", evidence: "Becoming human is becoming individual", critique: "Methodological Rigor. Studies systematic relationships", verdict: "light" },
                            { name: "Co-Evolution", evidence: "Culture was ingredient in production of animal", critique: "Structural Integrity. Explains neocortex expansion", verdict: "light" }
                        ],
                        summary: "Man is artifact of own creation. Software enables function."
                    }
                },
                comparison: [
                    ["Metaphor", "Peeling an Onion", "Building a Cathedral"],
                    ["Human Nature", "Constant / Hidden Core", "Variable / Programmed"],
                    ["Biology/Culture", "Separate Layers", "Interactive / Co-constitutive"],
                    ["The Particular", "Accidental / Irrelevant", "Essential / Constitutive"]
                ],
                verdict: "Anatomist searches for a ghost; Architect analyzes the living machine. Man is artifact of own creation."
            }
        ];

        // ------- STATE -------
        let idx = 0;
        let tab = "read";
        const readerModes = ["compact", "normal", "large"];

        // ------- DOM -------
        const listEl = document.getElementById("list");
        const searchEl = document.getElementById("searchInput");

        const meetLineEl = document.getElementById("meetLine");
        const loglineEl = document.getElementById("logline");
        const matchIdPillEl = document.getElementById("matchIdPill");

        const essayTitleEl = document.getElementById("essayTitle");
        const essayTeaserEl = document.getElementById("essayTeaser");
        const metaRowEl = document.getElementById("metaRow");
        const essayBodyEl = document.getElementById("essayBody");
        const verdictEl = document.getElementById("verdictText");
        const winnerTagEl = document.getElementById("winnerTag");

        const arenaGridEl = document.getElementById("arenaGrid");

        const cmpHeadsEl = document.getElementById("cmpHeads");
        const cmpTableEl = document.getElementById("cmpTable");

        // ------- HELPERS -------
        const esc = (s) => String(s)
            .replaceAll("&", "&amp;").replaceAll("<", "&lt;").replaceAll(">", "&gt;")
            .replaceAll('"', "&quot;").replaceAll("'", "&#39;");

        function meetsLine(m) {
            const p1 = m.p1.name.split("\n")[0].trim();
            const p2 = m.p2.name.split("\n")[0].trim();
            return `THE ${p1} MEETS THE ${p2}`;
        }

        function winnerOf(m) {
            return (m.p1.score >= m.p2.score) ? m.p1 : m.p2;
        }
        function loserOf(m) {
            return (m.p1.score >= m.p2.score) ? m.p2 : m.p1;
        }

        function setCSSColors(m) {
            document.documentElement.style.setProperty("--p1", m.p1.color);
            document.documentElement.style.setProperty("--p2", m.p2.color);
        }

        function setTab(next) {
            tab = next;
            document.querySelectorAll(".tab").forEach(t => t.classList.toggle("active", t.dataset.tab === next));
            document.getElementById("view-read").style.display = (next === "read") ? "block" : "none";
            document.getElementById("view-arena").style.display = (next === "arena") ? "block" : "none";
            document.getElementById("view-compare").style.display = (next === "compare") ? "block" : "none";
            document.getElementById("content").scrollTop = 0;
            localStorage.setItem("arenaTab", tab);
        }

        function renderSidebar() {
            listEl.innerHTML = "";
            matches.forEach((m, i) => {
                const div = document.createElement("div");
                div.className = "item" + (i === idx ? " active" : "");
                div.innerHTML = `
          <div class="tag">${esc(m.id)}</div>
          <div class="title">${esc(m.title)}</div>
          <div class="sub">${esc(m.logline)}</div>
        `;
                div.onclick = () => { load(i); closeSidebar(); };
                listEl.appendChild(div);
            });
        }

        function renderRead(m) {
            const p1Short = m.p1.name.replace("\n", " ");
            const p2Short = m.p2.name.replace("\n", " ");
            const w = winnerOf(m);
            const l = loserOf(m);

            essayTitleEl.textContent = m.title;
            essayTeaserEl.textContent = m.teaser;

            winnerTagEl.textContent = `Winner: ${w.name.replace("\n", " ")} (${w.score})`;

            metaRowEl.innerHTML = `
        <div class="chip"><span class="mini" style="background:${esc(m.p1.color)}"></span><strong>${esc(p1Short)}</strong> ${esc(m.p1.score)}</div>
        <div class="chip"><span class="mini" style="background:${esc(m.p2.color)}"></span><strong>${esc(p2Short)}</strong> ${esc(m.p2.score)}</div>
        <div class="chip"><span class="mini"></span><strong>Margin</strong> ${Math.abs(m.p1.score - m.p2.score)}pts</div>
      `;

            essayBodyEl.innerHTML = m.essay
                .split("\n\n")
                .map(p => `<p>${esc(p)}</p>`)
                .join("");

            verdictEl.innerHTML = `<p>${esc(m.verdict)}</p>`;
        }

        function fighterCardHTML(f, isWinner) {
            const name = f.name;
            const type = f.type;
            const stats = (f.stats || []).slice(0, 6);
            const verdictLabel = isWinner ? "VERDICT: LIGHT" : "VERDICT: SHADOW";
            return `
        <div class="fighter" style="color:${esc(f.color)}" role="button" tabindex="0">
          <div class="fighterHeader">
            <div>
              <div class="fname">${esc(name)}</div>
              <div class="ftype">${esc(type)}</div>
            </div>
            <div class="score">${String(f.score).padStart(2, "0")}</div>
          </div>

          ${(stats.length ? stats.map(s => `
            <div class="kv">
              <span style="color:color-mix(in srgb, var(--text) 90%, #000)">${esc(s.label)}</span>
              <span>${esc(s.val)}</span>
            </div>
          `).join("") : "")}

          <div class="verdictLine">
            <i class="fa-solid fa-circle" style="font-size:10px;"></i>
            ${esc(verdictLabel)}
          </div>

          ${f.assessment?.summary ? `
            <div class="card" style="margin-top:12px;border-color:color-mix(in srgb, currentColor 40%, var(--border));background:#070707">
              <div class="cardTitle" style="margin-bottom:6px;">
                <h3 style="color:color-mix(in srgb, var(--text) 88%, #000)">Summary</h3>
                <div class="mut">Guardian</div>
              </div>
              <div class="prose" style="font-size:14px;line-height:1.65">
                <p>${esc(f.assessment.summary)}</p>
              </div>
            </div>
          ` : ""}
        </div>
      `;
        }

        function renderArena(m) {
            const p1Wins = m.p1.score >= m.p2.score;
            arenaGridEl.innerHTML = `
        ${fighterCardHTML(m.p1, p1Wins)}
        ${fighterCardHTML(m.p2, !p1Wins)}
      `;

            // keyboard access on cards
            arenaGridEl.querySelectorAll(".fighter").forEach((el, n) => {
                el.addEventListener("keydown", (e) => {
                    if (e.key === "Enter" || e.key === " ") {
                        e.preventDefault();
                        // jump to compare view for quick skim
                        setTab("compare");
                    }
                });
            });
        }

        function renderCompare(m) {
            const p1 = m.p1.name.replace("\n", " ");
            const p2 = m.p2.name.replace("\n", " ");
            cmpHeadsEl.textContent = `${p1} vs ${p2}`;

            const rows = (m.comparison || []).map(r => {
                const [k, a, b] = r;
                return `
          <div class="cmpRow">
            <div class="k">${esc(k)}</div>
            <div class="ab">
              <div><strong style="color:${esc(m.p1.color)}">${esc(p1)}</strong><br>${esc(a)}</div>
              <div><strong style="color:${esc(m.p2.color)}">${esc(p2)}</strong><br>${esc(b)}</div>
            </div>
          </div>
        `;
            }).join("");

            cmpTableEl.innerHTML = rows || `<div class="cmpRow"><div class="k">No comparison data</div></div>`;
        }

        function load(i) {
            idx = Math.max(0, Math.min(matches.length - 1, i));
            const m = matches[idx];

            setCSSColors(m);
            meetLineEl.textContent = meetsLine(m);
            loglineEl.textContent = m.logline;
            matchIdPillEl.textContent = m.id;

            // sidebar active marker
            document.querySelectorAll(".item").forEach((el, n) => el.classList.toggle("active", n === idx));

            renderRead(m);
            renderArena(m);
            renderCompare(m);

            localStorage.setItem("arenaIdx", String(idx));
        }

        // ------- Sidebar controls (mobile overlay) -------
        function toggleSidebar() {
            const open = document.body.getAttribute("data-sb") === "open";
            document.body.setAttribute("data-sb", open ? "closed" : "open");
        }
        function closeSidebar() {
            document.body.setAttribute("data-sb", "closed");
        }

        // ------- Navigation -------
        function nextMatch() { load(idx + 1); }
        function prevMatch() { load(idx - 1); }
        function randomMatch() { load(Math.floor(Math.random() * matches.length)); }

        // ------- Reader controls -------
        function cycleReader() {
            const cur = document.body.getAttribute("data-reader") || "normal";
            const next = readerModes[(readerModes.indexOf(cur) + 1) % readerModes.length];
            document.body.setAttribute("data-reader", next);
            localStorage.setItem("arenaReader", next);
        }
        function toggleScanlines() {
            const cur = document.body.getAttribute("data-scanlines") || "on";
            const next = (cur === "on") ? "off" : "on";
            document.body.setAttribute("data-scanlines", next);
            localStorage.setItem("arenaScanlines", next);
        }

        // ------- Copy helpers -------
        async function copyText(txt) {
            try { await navigator.clipboard.writeText(txt); }
            catch {
                const ta = document.createElement("textarea");
                ta.value = txt; document.body.appendChild(ta);
                ta.select(); document.execCommand("copy"); ta.remove();
            }
        }
        function copyEssay() {
            const m = matches[idx];
            copyText(`${m.id} — ${m.title}\n${meetsLine(m)}\n${m.logline}\n\n${m.essay}\n\nVERDICT:\n${m.verdict}`);
        }
        function copyVerdict() {
            const m = matches[idx];
            copyText(`${m.id} — VERDICT\n${m.verdict}`);
        }

        function focusSearch() {
            openSidebarForSearch();
            setTimeout(() => searchEl.focus(), 0);
        }
        function openSidebarForSearch() {
            document.body.setAttribute("data-sb", "open");
        }

        // ------- Search filter -------
        searchEl.addEventListener("input", (e) => {
            const q = e.target.value.trim().toLowerCase();
            document.querySelectorAll(".item").forEach((el, i) => {
                const m = matches[i];
                const hay = `${m.id} ${m.title} ${m.logline}`.toLowerCase();
                el.style.display = hay.includes(q) ? "flex" : "none";
            });
        });

        // ------- Keyboard -------
        document.addEventListener("keydown", (e) => {
            const k = e.key;

            if (k === "Escape") {
                closeSidebar();
            }
            if (k === "/") {
                e.preventDefault();
                focusSearch();
            }
            if (k.toLowerCase() === "m") {
                toggleSidebar();
            }
            if (k.toLowerCase() === "r") {
                randomMatch();
            }
            if (k.toLowerCase() === "a") {
                cycleReader();
            }
            if (k === "ArrowRight" || k === "ArrowDown") {
                nextMatch();
            }
            if (k === "ArrowLeft" || k === "ArrowUp") {
                prevMatch();
            }
            if (k === "1") { setTab("read"); }
            if (k === "2") { setTab("arena"); }
            if (k === "3") { setTab("compare"); }
        });

        // ------- Touch swipe (match nav) -------
        (function enableSwipeNav() {
            let sx = 0, sy = 0, st = 0;
            const threshold = 55;
            const restraint = 50;
            const allowedTime = 450;

            document.addEventListener("touchstart", (e) => {
                const t = e.changedTouches[0];
                sx = t.pageX; sy = t.pageY; st = Date.now();
            }, { passive: true });

            document.addEventListener("touchend", (e) => {
                const t = e.changedTouches[0];
                const dx = t.pageX - sx;
                const dy = t.pageY - sy;
                const dt = Date.now() - st;

                if (dt <= allowedTime && Math.abs(dx) >= threshold && Math.abs(dy) <= restraint) {
                    if (dx < 0) nextMatch();
                    else prevMatch();
                }
            }, { passive: true });
        })();

        // ------- Persist settings -------
        (function restore() {
            const savedIdx = Number(localStorage.getItem("arenaIdx"));
            const savedTab = localStorage.getItem("arenaTab");
            const savedReader = localStorage.getItem("arenaReader");
            const savedScan = localStorage.getItem("arenaScanlines");

            if (!Number.isNaN(savedIdx)) idx = Math.max(0, Math.min(matches.length - 1, savedIdx));
            if (savedTab) tab = savedTab;
            if (savedReader) document.body.setAttribute("data-reader", savedReader);
            if (savedScan) document.body.setAttribute("data-scanlines", savedScan);

            renderSidebar();
            load(idx);
            setTab(tab || "read");

            // start closed on mobile
            document.body.setAttribute("data-sb", "closed");
        })();
    </script>
</body>

</html>